---
title: "Rozk쓰dy beta"
author: "A.Brodecka"
output:
   html_document:
     highlight: espresso
     keep_md: yes
     number_sections: yes
     theme: flatly
     toc: yes
     toc_depth: 3
---


```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = FALSE, cache = FALSE)
```

```{r, echo = FALSE, include= FALSE}

source('C:/Users/ola/Desktop/met/metR/Rcodes/function_preprocessing.R')
source('C:/Users/ola/Desktop/met/metR/Rcodes/libraries.R')
options(scipen=10000)
library(gplots)

```



# Metoda 1.



### Regresja logistyczna:

```{r}
l <- readRDS('C:/Users/ola/Desktop/met/Log_reg_pr_1.rds')
l %>% filter(!is.na(pValue)) -> l

ggplot(l, aes(x = log(abs(beta)))) + 
  geom_density() + ggtitle('Rozk쓰d warto띾i beta')  +
  theme_minimal()  + theme(title = element_text(size = 20), axis.title = element_text(size = 17),
                                        axis.text = element_text(size = 14)) +
  labs(x="Log(beta)",y="Czestosc")



```


### Regresja logistyczna z efektami losowymi:

```{r}
m <- readRDS('C:/Users/ola/Desktop/met/Mixed_reg_pr_1.rds')

m %>% filter(!is.na(pValue)) -> m

ggplot(m, aes(x = log(abs(beta)))) + 
  geom_density() + ggtitle('Rozk쓰d warto띾i beta')  +
  theme_minimal()  + theme(title = element_text(size = 20), axis.title = element_text(size = 17),
                                        axis.text = element_text(size = 14)) +
  labs(x="Log(beta)",y="Czestosc")



```


### Regresja logistyczna z efektami losowymi z uwzgl師nieniem korelacji:

```{r}
c <- readRDS('C:/Users/ola/Desktop/met/Corr_reg_pr_1.rds')
c %>% filter(!is.na(pValue)) -> c

ggplot(c, aes(x = log(abs(beta)))) + 
  geom_density() + ggtitle('Rozk쓰d warto띾i beta')  +
  theme_minimal()  + theme(title = element_text(size = 20), axis.title = element_text(size = 17),
                                        axis.text = element_text(size = 14)) +
  labs(x="Log(beta)",y="Czestosc")

```




# Metoda 2.

## p = 0.02

```{r}
sym <- readRDS('C:/Users/ola/Desktop/met/summary_pr_3_0.02.rds')



```



### Regresja logistyczna:

```{r}
l <- readRDS('C:/Users/ola/Desktop/met/Log_reg_pr_3_0.02.rds')
l %>% filter(!is.na(pValue)) %>% mutate(prob_name = paste0(tiles, '_', no_prob)) %>%
 left_join(sym, on = "prob_name") -> l
l$type <- as.factor(l$type)

ggplot(l, aes(x = log(abs(beta)), fill = type)) + 
  geom_density(alpha = 0.5) + ggtitle('Rozk쓰d warto띾i beta')  +
  theme_minimal()  + theme(title = element_text(size = 20), axis.title = element_text(size = 17),
                                        axis.text = element_text(size = 14)) +
  labs(x="Log(beta)",y="Czestosc")
```


### Regresja logistyczna z efektami losowymi:

```{r}
m <- readRDS('C:/Users/ola/Desktop/met/Mixed_reg_pr_3_0.02.rds')

m %>% filter(!is.na(pValue)) %>% mutate(prob_name = paste0(tiles, '_', no_prob)) %>%
 left_join(sym, on = "prob_name") -> m
m$type <- as.factor(m$type)

ggplot(m, aes(x = log(abs(beta)), fill = type)) + 
  geom_density(alpha = 0.5) + ggtitle('Rozk쓰d warto띾i beta')  +
  theme_minimal()  + theme(title = element_text(size = 20), axis.title = element_text(size = 17),
                                        axis.text = element_text(size = 14)) +
  labs(x="Log(beta)",y="Czestosc")

```


### Regresja logistyczna z efektami losowymi z uwzgl師nieniem korelacji:

```{r}
c <- readRDS('C:/Users/ola/Desktop/met/Corr_reg_pr_3_0.02.rds')

c %>% filter(!is.na(pValue)) %>% mutate(prob_name = paste0(tiles, '_', no_prob)) %>%
 left_join(sym, on = "prob_name") -> c
c$type <- as.factor(c$type)

ggplot(c, aes(x = log(abs(beta)), fill = type)) + 
  geom_density(alpha = 0.5) + ggtitle('Rozk쓰d warto띾i beta')  +
  theme_minimal()  + theme(title = element_text(size = 20), axis.title = element_text(size = 17),
                                        axis.text = element_text(size = 14)) +
  labs(x="Log(beta)",y="Czestosc")

```




## p = 0.04

```{r}
sym <- readRDS('C:/Users/ola/Desktop/met/summary_pr_3_0.04.rds')
```




### Regresja logistyczna:

```{r}
l <- readRDS('C:/Users/ola/Desktop/met/Log_reg_pr_3_0.04.rds')
l %>% filter(!is.na(pValue)) %>% mutate(prob_name = paste0(tiles, '_', no_prob)) %>%
 left_join(sym, on = "prob_name") -> l

l$type <- as.factor(l$type)

ggplot(l, aes(x = log(abs(beta)), fill = type)) + 
  geom_density(alpha = 0.5) + ggtitle('Rozk쓰d warto띾i beta')  +
  theme_minimal()  + theme(title = element_text(size = 20), axis.title = element_text(size = 17),
                                        axis.text = element_text(size = 14)) +
  labs(x="Log(beta)",y="Czestosc")
```


### Regresja logistyczna z efektami losowymi:

```{r}
m <- readRDS('C:/Users/ola/Desktop/met/Mixed_reg_pr_3_0.04.rds')

m %>% filter(!is.na(pValue)) %>% mutate(prob_name = paste0(tiles, '_', no_prob)) %>%
 left_join(sym, on = "prob_name") -> m

m$type <- as.factor(m$type)

ggplot(m, aes(x = log(abs(beta)), fill = type)) + 
  geom_density(alpha = 0.5) + ggtitle('Rozk쓰d warto띾i beta')  +
  theme_minimal()  + theme(title = element_text(size = 20), axis.title = element_text(size = 17),
                                        axis.text = element_text(size = 14)) +
  labs(x="Log(beta)",y="Czestosc")

```


### Regresja logistyczna z efektami losowymi z uwzgl師nieniem korelacji:

```{r}
c <- readRDS('C:/Users/ola/Desktop/met/Corr_reg_pr_3_0.04.rds')

c %>% filter(!is.na(pValue)) %>% mutate(prob_name = paste0(tiles, '_', no_prob)) %>%
 left_join(sym, on = "prob_name") -> c

c$type <- as.factor(c$type)

ggplot(c, aes(x = log(abs(beta)), fill = type)) + 
  geom_density(alpha = 0.5) + ggtitle('Rozk쓰d warto띾i beta')  +
  theme_minimal()  + theme(title = element_text(size = 20), axis.title = element_text(size = 17),
                                        axis.text = element_text(size = 14)) +
  labs(x="Log(beta)",y="Czestosc")

```




## p = 0.06

```{r}
sym <- readRDS('C:/Users/ola/Desktop/met/summary_pr_3_0.06.rds')
```



### Regresja logistyczna:

```{r}
l <- readRDS('C:/Users/ola/Desktop/met/Log_reg_pr_3_0.06.rds')
l %>% filter(!is.na(pValue)) %>% mutate(prob_name = paste0(tiles, '_', no_prob)) %>%
 left_join(sym, on = "prob_name") -> l

l$type <- as.factor(l$type)

ggplot(l, aes(x = log(abs(beta)), fill = type)) + 
  geom_density(alpha = 0.5) + ggtitle('Rozk쓰d warto띾i beta')  +
  theme_minimal()  + theme(title = element_text(size = 20), axis.title = element_text(size = 17),
                                        axis.text = element_text(size = 14)) +
  labs(x="Log(beta)",y="Czestosc")
```


### Regresja logistyczna z efektami losowymi:

```{r}
m <- readRDS('C:/Users/ola/Desktop/met/Mixed_reg_pr_3_0.06.rds')

m %>% filter(!is.na(pValue)) %>% mutate(prob_name = paste0(tiles, '_', no_prob)) %>%
 left_join(sym, on = "prob_name") -> m

m$type <- as.factor(m$type)

ggplot(m, aes(x = log(abs(beta)), fill = type)) + 
  geom_density(alpha = 0.5) + ggtitle('Rozk쓰d warto띾i beta')  +
  theme_minimal()  + theme(title = element_text(size = 20), axis.title = element_text(size = 17),
                                        axis.text = element_text(size = 14)) +
  labs(x="Log(beta)",y="Czestosc")

```


### Regresja logistyczna z efektami losowymi z uwzgl師nieniem korelacji:

```{r}
c <- readRDS('C:/Users/ola/Desktop/met/Corr_reg_pr_3_0.06.rds')

c %>% filter(!is.na(pValue)) %>% mutate(prob_name = paste0(tiles, '_', no_prob)) %>%
 left_join(sym, on = "prob_name") -> c

c$type <- as.factor(c$type)

ggplot(c, aes(x = log(abs(beta)), fill = type)) + 
  geom_density(alpha = 0.5) + ggtitle('Rozk쓰d warto띾i beta')  +
  theme_minimal()  + theme(title = element_text(size = 20), axis.title = element_text(size = 17),
                                        axis.text = element_text(size = 14)) +
  labs(x="Log(beta)",y="Czestosc")

```


## p = 0.08

```{r}
sym <- readRDS('C:/Users/ola/Desktop/met/summary_pr_3_0.08.rds')
```



### Regresja logistyczna:

```{r}
l <- readRDS('C:/Users/ola/Desktop/met/Log_reg_pr_3_0.08.rds')
l %>% filter(!is.na(pValue)) %>% mutate(prob_name = paste0(tiles, '_', no_prob)) %>%
 left_join(sym, on = "prob_name") -> l

l$type <- as.factor(l$type)

ggplot(l, aes(x = log(abs(beta)), fill = type)) + 
  geom_density(alpha = 0.5) + ggtitle('Rozk쓰d warto띾i beta')  +
  theme_minimal()  + theme(title = element_text(size = 20), axis.title = element_text(size = 17),
                                        axis.text = element_text(size = 14)) +
  labs(x="Log(beta)",y="Czestosc")
```


### Regresja logistyczna z efektami losowymi:

```{r}
m <- readRDS('C:/Users/ola/Desktop/met/Mixed_reg_pr_3_0.08.rds')



m %>% filter(!is.na(pValue)) %>% mutate(prob_name = paste0(tiles, '_', no_prob)) %>%
 left_join(sym, on = "prob_name") -> m

m$type <- as.factor(m$type)

ggplot(m, aes(x = log(abs(beta)), fill = type)) + 
  geom_density(alpha = 0.5) + ggtitle('Rozk쓰d warto띾i beta')  +
  theme_minimal()  + theme(title = element_text(size = 20), axis.title = element_text(size = 17),
                                        axis.text = element_text(size = 14)) +
  labs(x="Log(beta)",y="Czestosc")

```


### Regresja logistyczna z efektami losowymi z uwzgl師nieniem korelacji:

```{r}
c <- readRDS('C:/Users/ola/Desktop/met/Corr_reg_pr_3_0.08.rds')

c %>% filter(!is.na(pValue)) %>% mutate(prob_name = paste0(tiles, '_', no_prob)) %>%
 left_join(sym, on = "prob_name") -> c

c$type <- as.factor(c$type)

ggplot(c, aes(x = log(abs(beta)), fill = type)) + 
  geom_density(alpha = 0.5) + ggtitle('Rozk쓰d warto띾i beta')  +
  theme_minimal()  + theme(title = element_text(size = 20), axis.title = element_text(size = 17),
                                        axis.text = element_text(size = 14)) +
  labs(x="Log(beta)",y="Czestosc")

```



## p = 0.1

```{r}
sym <- readRDS('C:/Users/ola/Desktop/met/summary_pr_3_0.1.rds')
```



### Regresja logistyczna:

```{r}
l <- readRDS('C:/Users/ola/Desktop/met/Log_reg_pr_3_0.1.rds')
l %>% filter(!is.na(pValue)) %>% mutate(prob_name = paste0(tiles, '_', no_prob)) %>%
 left_join(sym, on = "prob_name") -> l

l$type <- as.factor(l$type)

ggplot(l, aes(x = log(abs(beta)), fill = type)) + 
  geom_density(alpha = 0.5) + ggtitle('Rozk쓰d warto띾i beta')  +
  theme_minimal()  + theme(title = element_text(size = 20), axis.title = element_text(size = 17),
                                        axis.text = element_text(size = 14)) +
  labs(x="Log(beta)",y="Czestosc")
```


### Regresja logistyczna z efektami losowymi:

```{r}
m <- readRDS('C:/Users/ola/Desktop/met/Mixed_reg_pr_3_0.1.rds')

m %>% filter(!is.na(pValue)) %>% mutate(prob_name = paste0(tiles, '_', no_prob)) %>%
 left_join(sym, on = "prob_name") -> m

m$type <- as.factor(m$type)

ggplot(m, aes(x = log(abs(beta)), fill = type)) + 
  geom_density(alpha = 0.5) + ggtitle('Rozk쓰d warto띾i beta')  +
  theme_minimal()  + theme(title = element_text(size = 20), axis.title = element_text(size = 17),
                                        axis.text = element_text(size = 14)) +
  labs(x="Log(beta)",y="Czestosc")

```


### Regresja logistyczna z efektami losowymi z uwzgl師nieniem korelacji:

```{r}
c <- readRDS('C:/Users/ola/Desktop/met/Corr_reg_pr_3_0.1.rds')

c %>% filter(!is.na(pValue)) %>% mutate(prob_name = paste0(tiles, '_', no_prob)) %>%
 left_join(sym, on = "prob_name") -> c

c$type <- as.factor(c$type)

ggplot(c, aes(x = log(abs(beta)), fill = type)) + 
  geom_density(alpha = 0.5) + ggtitle('Rozk쓰d warto띾i beta')  +
  theme_minimal()  + theme(title = element_text(size = 20), axis.title = element_text(size = 17),
                                        axis.text = element_text(size = 14)) +
  labs(x="Log(beta)",y="Czestosc")

```
